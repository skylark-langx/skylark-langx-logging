{"version":3,"sources":["skylark-langx-logging.js"],"names":["define","skylark","attach","logging","levels","all","off","debug","info","warn","error","DEFAULT","objects","klass","history","Logger","_level","_construct","name","this","_logByType","log","type","level","args","lvl","lvlRegExp","RegExp","unshift","toUpperCase","push","concat","splice","length","window","console","fn","test","Array","isArray","LogByTypeFactory","hasOwnProperty","Error","createLogger","subname","mixin","prototype","enable","filter","fname","historyItem","clear","disable","root","rootLogger","main"],"mappings":";;;;;;;g4BAAAA,EAAA,iCACA,oBACA,SAAAC,GAGA,OAAAA,EAAAC,OAAA,sBAIAF,EAAA,gCACA,aACA,SAAAG,GACA,OAAAA,EAAAC,QACAC,IAAA,wBACAC,IAAA,GACAC,MAAA,wBACAC,KAAA,kBACAC,KAAA,aACAC,MAAA,QACAC,QAAA,UAGAX,EAAA,gCACA,wBACA,iCACA,YACA,YACA,SAAAY,EAAAC,EAAAV,EAAAC,GACA,aAEA,IAAAU,KA2BA,IAAAC,EAAAF,GACAG,OAAA,OAEAC,WAAA,SAAAC,GACAC,KAAAD,KAAAA,EAEAC,KAAAC,WA/BA,EAAAF,EAAAG,IAAA,CAAAC,EAAAC,EAAAC,KACA,MAAAC,EAAArB,EAAAmB,GACAG,EAAA,IAAAC,YAAAF,OAKA,GAJA,QAAAH,GACAE,EAAAI,QAAAN,EAAAO,cAAA,KAEAL,EAAAI,QAAAV,EAAA,KACAJ,EAAA,CACAA,EAAAgB,QAAAC,OAAAP,IACA,MAAAQ,EAAAlB,EAAAmB,OAAA,IACAnB,EAAAkB,OAAA,EAAAA,EAAA,EAAAA,EAAA,GAEA,IAAAE,OAAAC,QACA,OAEA,IAAAC,EAAAF,OAAAC,QAAAb,GACAc,GAAA,UAAAd,IACAc,EAAAF,OAAAC,QAAA3B,MAAA0B,OAAAC,QAAAd,KAEAe,GAAAX,GAAAC,EAAAW,KAAAf,IAGAc,EAAAE,MAAAC,QAAAf,GAAA,QAAA,QAAAU,OAAAC,QAAAX,IASAgB,CAAAtB,EAAAG,MAGAE,MAAA,SAAAE,GACA,GAAA,iBAAAA,EAAA,CACA,IAAArB,EAAAqC,eAAAhB,GACA,MAAA,IAAAiB,UAAAjB,+BAEAN,KAAAH,OAAAS,EAEA,OAAAN,KAAAH,QAGAN,MAAA,YAAAc,GACAL,KAAAC,WAAA,QAAAD,KAAAH,OAAAQ,IAGAf,KAAA,YAAAe,GAhFAL,KAAAC,WAAA,OAAAD,KAAAH,OAAAQ,IAGAjB,MAAA,YAAAiB,GACAL,KAAAC,WAAA,QAAAD,KAAAH,OAAAQ,IAGAhB,KAAA,YAAAgB,GACAL,KAAAC,WAAA,OAAAD,KAAAH,OAAAQ,IAIAmB,aAAA,SAAAC,GACA,OAAA,IAAA7B,EAAAI,KAAAD,KAAAC,KAAAD,KAAA,KAAA0B,EAAAA,MAiCA,OA3BAhC,EAAAiC,MAAA9B,EAAA+B,UAAAhC,SACAiC,OAAA,WACA,OAAAjC,IACAA,OAIAkC,OAAA,SAAAC,GACA,OAAAnC,OAAAkC,OAAAE,GACA,IAAAvB,YAAAsB,OAAAZ,KAAAa,EAAA,MAGAC,MAAA,WACArC,IACAA,EAAAmB,OAAA,IAGAmB,QAAA,WACA,OAAAtC,IACAA,EAAAmB,OAAA,EACAnB,EAAA,SAKAC,EAAAsC,KAAA,IAAAtC,EAAA,IAEAZ,EAAAY,OAAAA,IAGAf,EAAA,8BACA,YACA,YACA,SAAAG,EAAAY,GACA,IAAAuC,EAAAvC,EAAAsC,KAmBA,OAjBAlD,EAAAI,MAAA,YAAAiB,GACA8B,EAAA/C,SAAAiB,IAGArB,EAAAK,KAAA,YAAAgB,GACA8B,EAAA/C,SAAAiB,IAGArB,EAAAM,KAAA,YAAAe,GACA8B,EAAA/C,SAAAiB,IAGArB,EAAAO,MAAA,YAAAc,GACA8B,EAAA/C,SAAAiB,IAIArB,IAEAH,EAAA,yBAAA,8BAAA,SAAAuD,GAAA,OAAAA","file":"../skylark-langx-logging.js","sourcesContent":["define('skylark-langx-logging/logging',[\r\n  \"skylark-langx-ns\"\r\n],function(skylark){\r\n\r\n\r\n    return skylark.attach(\"langx.logging\",{\r\n\r\n    });\r\n});\ndefine('skylark-langx-logging/levels',[\r\n\t\"./logging\"\r\n],function(logging){\r\n    return logging.levels = {\r\n\t    all: 'debug|info|warn|error',\r\n\t    off: '',\r\n\t    debug: 'debug|info|warn|error',\r\n\t    info: 'info|warn|error',\r\n\t    warn: 'warn|error',\r\n\t    error: 'error',\r\n\t    DEFAULT: \"info\"\r\n    };\t\r\n});\ndefine('skylark-langx-logging/Logger',[\r\n    \"skylark-langx-objects\",\r\n    \"skylark-langx-constructs/klass\",\r\n    \"./logging\",\r\n    \"./levels\"\r\n],function(objects,klass,logging,levels){\r\n    'use strict';\r\n\r\n    let history = [];\r\n \r\n    const LogByTypeFactory = (name, log) => (type, level, args) => {\r\n        const lvl = levels[level];\r\n        const lvlRegExp = new RegExp(`^(${ lvl })$`);\r\n        if (type !== 'log') {\r\n            args.unshift(type.toUpperCase() + ':');\r\n        }\r\n        args.unshift(name + ':');\r\n        if (history) {\r\n            history.push([].concat(args));\r\n            const splice = history.length - 1000;\r\n            history.splice(0, splice > 0 ? splice : 0);\r\n        }\r\n        if (!window.console) {\r\n            return;\r\n        }\r\n        let fn = window.console[type];\r\n        if (!fn && type === 'debug') {\r\n            fn = window.console.info || window.console.log;\r\n        }\r\n        if (!fn || !lvl || !lvlRegExp.test(type)) {\r\n            return;\r\n        }\r\n        fn[Array.isArray(args) ? 'apply' : 'call'](window.console, args);\r\n    };\r\n\r\n    var Logger = klass({\r\n        _level : \"info\",\r\n\r\n        _construct : function(name) {\r\n            this.name = name;\r\n\r\n            this._logByType = LogByTypeFactory(name, log);\r\n        },\r\n\r\n        level : function(lvl) {\r\n            if (typeof lvl === 'string') {\r\n                if (!levels.hasOwnProperty(lvl)) {\r\n                    throw new Error(`\"${ lvl }\" in not a valid log level`);\r\n                }\r\n                this._level = lvl;\r\n            }\r\n            return this._level;\r\n        },\r\n\r\n        error : function(...args){ \r\n            this._logByType('error', this._level, args);\r\n        },\r\n\r\n        warn : function(...args){ \r\n            this._logByType('warn', this._level, args);\r\n        },\r\n\r\n        debug : function(...args){ \r\n            this._logByType('debug', this._level, args);\r\n        },\r\n\r\n        info : function(...args){ \r\n            this._logByType('info', this._level, args);\r\n        },\r\n\r\n\r\n        createLogger : function(subname) {\r\n            return new Logger(this.name ? this.name  + ': ' + subname : subname);   \r\n        },\r\n\r\n    });\r\n\r\n\r\n    objects.mixin(Logger.prototype.history,{\r\n        enable : function() {\r\n           if (history === null) {\r\n                history = [];\r\n            }            \r\n        },\r\n        \r\n        filter : function(fname) {\r\n            return (history || []).filter(historyItem => {\r\n                return new RegExp(`.*${ fname }.*`).test(historyItem[0]);\r\n            });\r\n        },\r\n        clear : function() {\r\n            if (history) {\r\n                history.length = 0;\r\n            }\r\n        },\r\n        disable : function()  {\r\n            if (history !== null) {\r\n                history.length = 0;\r\n                history = null;\r\n            }\r\n        }\r\n    });\r\n\r\n    Logger.root = new Logger(\"\");\r\n\r\n    return logging.Logger = Logger;\r\n\r\n});\ndefine('skylark-langx-logging/main',[\r\n\t\"./logging\",\r\n\t\"./Logger\"\r\n],function(logging,Logger){\r\n\tlet rootLogger = Logger.root;\r\n\r\n\tlogging.debug = function(...args) {\r\n\t\trootLogger.debug(...args);\r\n\t};\r\n\r\n\tlogging.info = function(...args) {\r\n\t\trootLogger.debug(...args);\r\n\t};\r\n\r\n\tlogging.warn = function(...args) {\r\n\t\trootLogger.debug(...args);\r\n\t};\r\n\r\n\tlogging.error = function(...args) {\r\n\t\trootLogger.debug(...args);\r\n\t};\r\n\r\n\r\n\treturn logging;\r\n});\ndefine('skylark-langx-logging', ['skylark-langx-logging/main'], function (main) { return main; });\n\n"]}